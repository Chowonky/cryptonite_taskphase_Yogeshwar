## Who are you?
- went over all the source files, found nothing useful
- since the website says `Only people who use the official PicoBrowser are allowed on this site!` I changed the request's `User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36` header to `User-Agent: PicoBrowser` (basically changed the user agent from firefox to picobrowser)
- And now the website says `I don't trust users visiting from another site.`
- I somehow have to manipulate it into thinking that I'm directly visiting the site, but how?
- searched how to do it
- added a blank `Referer` tab to the request, nothing happened though.
- instead of blank `Referer`, used `http://mercury.picoctf.net:46199/` itself as the referer and now the website says `Sorry, this site only worked in 2018.`
- So now I have make it think its 2018
- added a `Date` header to change the year
- It now says `I don't trust users who can be tracked`
- asked gpt to list all possible tracking headers
- tried removing combinations of them and updated `Connection: keep-alive` to `close`, no success
- stuck at `I don't trust users who can be tracked`
- `Referer`, `Date`, `User-Agent` can be used for tracking but removing them takes me back to previous messages.
- my current request: 
```
GET / HTTP/1.1
Host: mercury.picoctf.net:46199
Referer: http://mercury.picoctf.net:46199/
Date: 2018
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
User-Agent: PicoBrowser
Accept: 
Accept-Encoding: 
Accept-Language: 
Connection: close

```
- removing the `Accept` headers did nothing either
- thinking of using vpn 
- asked gpt how to tell the server to not track through an http request
- added `DNT` header
- it now says `This website is only for people from Sweden.`
- made the server think I am from sweden by using `X-Forwarded-For: 89.160.67.118` (tells the website that my original ip is sweden based)
`89.160.67.118`-> random swedish ip
```
The X-Forwarded-For (XFF) header is used to track the original IP address of a client making an HTTP request when the request passes through a proxy server or load balancer. Without this header, a server would only see the IP address of the last proxy or load balancer in the chain, not the original client's IP.
How It Works:

    Client makes a request: A client (e.g., a user’s browser) sends a request to a web server.
    Proxy adds the header: If the request goes through a proxy or load balancer, the proxy adds the client’s original IP address to the X-Forwarded-For header.
    Multiple proxies: If the request passes through multiple proxies, each proxy adds its own IP to the header, creating a list of IPs.
    Final server reads the header: The final web server checks the X-Forwarded-For header to get the original IP address of the client.

Why It's Important:

    Tracking the original IP: It helps the server identify the true origin of the request, even if the client’s request was forwarded by multiple proxies.
    Geolocation: Websites may use the client’s IP for location-based content or services.
    Logging & Security: Servers can log the actual client IP for auditing or security measures.

Security Note:

    Can be spoofed: Since X-Forwarded-For is an HTTP header, it can be manipulated by the client or any intermediary proxy. Therefore, it's important for the server to trust only trusted proxies when using this header.
```
- now the website says `You're in Sweden but you don't speak Swedish?`
- modified the `Accept-Language` header to accept swedish language -> `Accept-Language:sv-SE `
- got the flag finally 